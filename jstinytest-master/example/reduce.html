<script src="../tinytest.js"></script>
<script>

// =========================================
// PLAYGROUND
// =========================================
var numbers = [1, 2, 3, 4];
//console.log(numbers);

function adder(sumSoFar, nextNumber) {
  return sumSoFar + nextNumber;
}

var sumSoFar = 0;
console.log(sumSoFar = adder(sumSoFar, numbers[0]));
console.log(sumSoFar = adder(sumSoFar, numbers[1]));
console.log(sumSoFar = adder(sumSoFar, numbers[2]));
console.log(sumSoFar = adder(sumSoFar, numbers[3]));

var sumSoFar = 0;
for (var i = 0; i < numbers.length; i++) {
  sumSoFar = adder(sumSoFar, numbers[i]);
}
console.log(sumSoFar);

function reduce(array, callback, startingValue) {
  var results = startingValue;
  for (var i = 0; i < array.length; i++) {
    results = callback(results, array[i]);
  }
  return results;
}

console.log("getSum " + reduce(numbers, adder, 0));

console.log(reduce(['k','e','n'], adder, ''));

// ==========================================
// Prototype implementation:
    // function reduce(array, callback, startingValue) {
    //     var resultSoFar = startingValue;
    //     for (var i = 0; i < array.length; i++) {
    //         resultSoFar = callback(resultSoFar, array[i], i, array);
    //     }
    //     return resultSoFar;
    // }

Function signature:
    reduce(array, callback[, initialValue])

Callback parameters:
    previousValue
    currentValue
    currentIndex
    array

Returns value:
    Returns a single value

Requirements:

    If initialValue, previousValue should start with initialValue.
    If initialValue, currentValue should start with array[0].
    If initialValue, callback will start at index 0.

    If no initialValue, previousValue should start with array[0].
    If no initialValue, currentValue should start with array[1].
    If no initialValue, callback will start at index 1.

    If initialValue, and array is empty, it should return initialValue without calling callback.
    If no intitalValue, and array and has one element, it should return only element without calling callback.

    It should actually reduce.
    If should exclude holes.
    If array is empty, and no initialValue, throw TypeError.
    It should pass array as fourth argument to callback.



// ==========================================
// The map() method creates a new array with the results of calling a provided function on every element in this array.

// map(originalArray, callback, optionalThis);
// callback = function(number, index, originalArray)

// Example 1: Callback should run 3 times.
// map([1, 2, 3], function() {});

// Example 2: Callback has access to ith element.
// map([1, 2, 3], function(number) {
//     console.log(number);
// });

// Example 3: Callback has access to index/position.
// map([1, 2, 3], function(number, index) {
//     console.log(index);
// });

// Example 4: Callback has access to original array.
// map([1, 2, 3], function(number, index, originalArray) {
//     console.log(originalArray);
// });

// Make sure that configurable this works.
// Example 5: Callback has access to optional this.
// map([1, 2, 3], function() {
//     console.log(this.name)
// }, {name: 'Gordon'});

// Example 6: Callback returns a new array.
// var originalArray = [1, 2, 3];
// var mappedArray = map(originalArray, function() {});
// originalArray !== mappedArray;

// Example 7:
// var originalArray = [1, 2, 3];
// var mappedArray = map(originalArray, function(element) {
//     return element * 2;
// });
// Expect mappedArray === [2, 4, 6]

function reduce(array, callback, startingValue) {
  var results = startingValue;
  for (var i = 0; i < array.length; i++) {
    results = callback(results, array[i]);
  }
  return results;
}

tests({
    'It should run the callback function array.length time.': function() {
        var numOfTimeCallbackHasRun = 0;
        map([1,2,3], function() {
            numOfTimeCallbackHasRun++;
        });
        eq(numOfTimeCallbackHasRun, 3);
    },
    'It should pass in the ith element as the first argument to the callback.': function() {
        map([1], function(number) {
            eq(number, 1);
        });
    },
    'It should pass in the ith position as the second argument to the callback.': function() {
        map([1], function(number, index) {
            eq(index, 0);
        });
    },
    'It should pass in the original array as the third argument to the callback.': function() {
        var testArray = [1, 2, 3];
        map(testArray, function(number, index, originalArray) {
            eq(originalArray, testArray);
        });
    },
    'It should accept an optional \'this\' object.': function() {
        map([1], function() {
            eq(this.description, 'I should be accessiblle inside of the callback.')
        }, {description: 'I should be accessiblle inside of the callback.'});
    },
    'It should return an array.': function() {
        var mappedArray = map([], function() {});
        eq(Array.isArray(mappedArray), true)
    },
    'It should return a new array, not the original array.': function() {
        var originalArray = [1, 2, 3];
        var mappedArray = map(originalArray, function() {});
        // filteredArray is not the original array
        eq(mappedArray !== originalArray, true);
    },
    'It should return a new array with same length of the original array.': function() {
        var mappedArray = map([1, 2, 3], function(element) {
            return element * 2;
        });
        eq(mappedArray.length, 3);
    },
    'It should return a new array with elements where callback returns true.': function() {
        var mappedArray = map([1, 2, 3], function(element) {
            return element * 2;
        });
        console.log(mappedArray);
        eq(mappedArray[0], 2);
        eq(mappedArray[1], 4);
        eq(mappedArray[2], 6);
    },
    'It should ignore unassigned indexes.': function() {
        var mappedArray = map([, 2, undefined], function(element) {
            return element;
        });
        eq(mappedArray[0], undefined);
        eq(mappedArray[1], 2);
        eq(mappedArray[2], undefined);
    }
});
</script>

